rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
library(dplyr)
library(tidyr)
setwd("~/Documents/git/treespotters/Data")
d<- read.csv("ts.observers.2016.csv", header=TRUE)
View(d)
obs<- d %>%
dplyr::select("ObservedBy_Person_ID", "First_Yes_DOY") %>%
mutate(ObservedBy_Person_ID = strsplit(as.character(ObservedBy_Person_ID), ",")) %>%
unnest(ObservedBy_Person_ID)
obs<- d %>%
dplyr::select(ObservedBy_Person_ID, First_Yes_DOY) %>%
mutate(ObservedBy_Person_ID = strsplit(as.character(ObservedBy_Person_ID), ",")) %>%
unnest(ObservedBy_Person_ID)
View(obs)
obs$ObservedBy_Person_ID<-as.numeric(as.character(d$ObservedBy_Person_ID))
obs[] <- lapply(obs, gsub, pattern=''', replacement='')
obs[] <- lapply(obs, gsub, pattern="'", replacement="")
View(obs)
total<-as.data.frame(as.table(d$ObservedBy_Person_ID))
total<-as.data.frame(table(d$ObservedBy_Person_ID))
View(total)
total<-as.data.frame(table(obs$ObservedBy_Person_ID))
View(total)
total<- total %>%
rename(Num=Freq)%>%
rename(obs=Var1)
total<- total %>%
rename(Num=Freq)%>%
rename(obs=Var1) %>%
ifelse(Num>=1, Num, NA)
total<-as.data.frame(table(obs$ObservedBy_Person_ID))
total<- total %>%
rename(Num=Freq)%>%
rename(obs=Var1) %>%
ifelse(Num>=1, Num, NA)
total<-as.data.frame(table(obs$ObservedBy_Person_ID))
total<- total %>%
rename(Num=Freq)%>%
rename(obs=Var1) %>%
ifelse(Num>1, Num, NA)
total<-as.data.frame(table(obs$ObservedBy_Person_ID))
total<- total %>%
rename(Num=Freq)%>%
rename(obs=Var1)
total$Num<-ifelse(total$Num>1, Num, NA)
View(total)
total$Num<-ifelse(total$Num>1, total$Num, NA)
total<-na.omit(total)
View(total)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
library(data.table)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses/input")
phenology<-read.csv("soil.moisture.csv",header=TRUE)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
library(data.table)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses/input")
d<-read.csv("soil.moisture.csv",header=TRUE)
View(d)
soil <- d %>%
dplyr::select(ID, percent, TX)
View(soil)
soil<-na.omit(soil)
View(soil)
soil<- soil%>%
group_by(ID) %>%
summarise_each(funs(mean))
soil<- soil%>%
group_by(ID, TX) %>%
summarise_each(funs(mean))
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil<- soil%>%
group_by(ID, TX) %>%
summarise_each(funs(mean))
View(d)
soil <- d %>%
dplyr::select(ID, percent, TX)
soil <- d %>%
dplyr::select(ID, percent)
soil<-na.omit(soil)
soil<- soil%>%
group_by(ID) %>%
summarise_each(funs(mean))
moisture<-right_join(d,soil, by ID)
moisture<-right_join(d,soil, by=ID)
moisture<-right_join(d,soil, by="ID")
View(moisture)
moisture<-full_join(d,soil, by="ID")
View(moisture)
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil<- soil%>%
group_by(ID) %>%
summarise_each(funs(mean))%>%
arrange(TX)
warnings()
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil<- soil%>%
group_by(ID) %>%
mutate_each(funs(mean))%>%
arrange(TX)
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil<- soil%>%
group_by(ID) %>%
mutate(funs(mean))%>%
arrange(TX)
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil$mean<-ave(soil$percent, soil$ID)
View(soil)
moisture<-moisture[duplicated(moisture), ]
moisture<- soil $>$
dplyr::select(-percent)
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil$mean<-ave(soil$percent, soil$ID)
moisture<- soil $>$
dplyr::select(-percent)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
library(data.table)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses/input")
d<-read.csv("soil.moisture.csv",header=TRUE)
# clean up dataframe
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil$mean<-ave(soil$percent, soil$ID)
moisture<- soil $>$
dplyr::select(-percent)
moisture<-moisture[!duplicated(moisture), ]
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil$mean<-ave(soil$percent, soil$ID)
moisture<- soil %>%
dplyr::select(-percent)
moisture<-moisture[!duplicated(moisture), ]
View(moisture)
arrange(moisture, ID)
moisture<-arrange(moisture, ID)
tx<- moisture %>%
dplyr::select(-ID)%>%
group_by(TX)%>%
summarise_each(funs(mean)
)
View(tx)
write.csv(tx, "output/Drought.csv", row.names= FALSE)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(arm)
library(data.table)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses")
d<-read.csv("input/soil.moisture.csv",header=TRUE)
# clean up dataframe
soil <- d %>%
dplyr::select(ID, percent, TX)
soil<-na.omit(soil)
soil$mean<-ave(soil$percent, soil$ID)
moisture<- soil %>%
dplyr::select(-percent)
moisture<-moisture[!duplicated(moisture), ]
moisture<-arrange(moisture, ID)
tx<- moisture %>%
dplyr::select(-ID)%>%
group_by(TX)%>%
summarise_each(funs(mean))
write.csv(tx, "output/Drought.csv", row.names= FALSE)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(lme4)
library(arm)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
View(d)
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
df$doy<-yday(df$date)
df$species<-substr(df$NEW, 0,6)
df<-dplyr::select(df, -date)
View(df)
View(d)
df$doy<-yday(df$date)
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
df$doy<-yday(df$date)
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
df$doy<-yday(df$date)
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
df$doy<-yday(df$date)
df$species<-substr(df$NEW, 0,6)
df<-dplyr::select(df, -date)
phases.9<-c("9","15")
df9<-filter(df, bbch %in% phases.9)
df9$bbch<- factor(df9$bbch, levels = c(9,15),
labels = c("Budburst","Leaves"))
risk9<- df9%>%
group_by(NEW, bbch)%>%
arrange(NEW)%>%
filter(row_number()==1) %>%
spread(bbch, doy)
risk9<-na.omit(risk9)
risk9$Risk <- risk9$Leaves - risk9$Budburst
ggplot(risk9, aes(x=species, y=Risk)) + geom_point(aes(col=as.factor(TX))) +
geom_smooth(aes(col=as.factor(TX)),method="loess", se=FALSE)
ggplot((risk9), aes(x=Budburst, y=NEW), stat="identity") + geom_point(aes(x= risk9$Budburst)) +
geom_segment(aes(y = NEW, yend = NEW, x = Budburst, xend = Leaves, col=TX)) +
geom_point(aes(x=Leaves, col=TX)) + geom_point(aes(col=TX)) +
xlab("Budburst to Leaf Out") +
ylab("Species")
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(lme4)
library(arm)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
# Organizing data
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
df$doy<-yday(df$date)
df$species<-substr(df$NEW, 0,6)
df<-dplyr::select(df, -date)
View(df)
View(d)
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
View(df)
d$date<-as.character(as.Date(d$date,"%m/%d/%y"))
as.Date(d$date,"%m/%d/%y")
df$date<-as.character(as.Date(df$date,"%m/%d/%y"))
df$doy<-yday(df$date)
df$species<-substr(df$NEW, 0,6)
df<-dplyr::select(df, -date)
View(df)
phases.9<-c("9","15")
df9<-filter(df, bbch %in% phases.9)
df9$bbch<- factor(df9$bbch, levels = c(9,15),
labels = c("Budburst","Leaves"))
risk9<- df9%>%
group_by(NEW, bbch)%>%
arrange(NEW)%>%
filter(row_number()==1) %>%
spread(bbch, doy)
risk9<-na.omit(risk9)
risk9$Risk <- risk9$Leaves - risk9$Budburst
ggplot(risk9, aes(x=species, y=Risk)) + geom_point(aes(col=as.factor(TX))) +
geom_smooth(aes(col=as.factor(TX)),method="loess", se=FALSE)
ggplot((risk9), aes(x=Budburst, y=NEW), stat="identity") + geom_point(aes(x= risk9$Budburst)) +
geom_segment(aes(y = NEW, yend = NEW, x = Budburst, xend = Leaves, col=TX)) +
geom_point(aes(x=Leaves, col=TX)) + geom_point(aes(col=TX)) +
xlab("Budburst to Leaf Out") +
ylab("Species")
risk<-risk9%>%
ungroup(NEW, Risk)%>%
dplyr::select(species, Risk)
risk.mean<- risk%>%
group_by(species) %>%
summarise_each(funs(mean))%>%
rename(mean=Risk)
risk.sd<-risk%>%
group_by(species) %>%
summarise_each(funs(sd)) %>%
rename(sd=Risk)
risk.species<-full_join(risk.mean, risk.sd)
tx<-risk9%>%
ungroup(NEW, Risk)%>%
dplyr::select(TX, Risk)
tx.mean<- tx%>%
group_by(TX) %>%
summarise_each(funs(mean))%>%
rename(mean=Risk)
tx.sd<-tx%>%
group_by(TX) %>%
summarise_each(funs(sd)) %>%
rename(sd=Risk)
tx.species<-full_join(tx.mean, tx.sd)
mod<-lm(Risk~species + TX, data=risk9)
display(mod)
View(tx.mean)
View(tx.sd)
View(tx.species)
View(risk.species)
View(tx.species)
View(df)
View(d)
phases.10<-c("9","10","15")
df10<-filter(df, bbch %in% phases.10)
df10$bbch<- factor(df10$bbch, levels = c(9,10,15),
labels = c("NA","Budburst","Leaves"))
View(df10)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(lme4)
library(arm)
# Set Working Directory
setwd("~/Documents/git/freezingexperiment/analyses")
d <-read.csv("input/bbch_data.csv", header=TRUE, check.names=FALSE)
# Organizing data
df<-gather(d, "date","bbch", -NEW, -TX)
df<-na.omit(df)
df$date<-as.character(as.Date(df$date,"%m/%d/%y"))
df$doy<-yday(df$date)
df$species<-substr(df$NEW, 0,6)
df<-dplyr::select(df, -date)
# Now start evaluating duration of vegetative risk
# 9 is using 9 as budburst, 10 is using 10. Some individuals, I missed 9 so it
# was sometime in between the observation dates
phases.9<-c("9","15")
df9<-filter(df, bbch %in% phases.9)
df9$bbch<- factor(df9$bbch, levels = c(9,15),
labels = c("Budburst","Leaves"))
phases.10<-c("9","10","15")
df10<-filter(df, bbch %in% phases.10)
df10$bbch<- factor(df10$bbch, levels = c(9,10,15),
labels = c("NA","Budburst","Leaves"))
risk9<- df9%>%
group_by(NEW, bbch)%>%
arrange(NEW)%>%
filter(row_number()==1) %>%
spread(bbch, doy)
risk9<-na.omit(risk9)
risk9$Risk <- risk9$Leaves - risk9$Budburst
risk10<- df10%>%
group_by(NEW, bbch)%>%
arrange(NEW)%>%
filter(row_number()==1) %>%
spread(bbch, doy)
risk10<-na.omit(risk10)
risk10$Risk <- risk10$Leaves - risk10$Budburst
# Some graphs
ggplot(risk9, aes(x=species, y=Risk)) + geom_point(aes(col=as.factor(TX))) +
geom_smooth(aes(col=as.factor(TX)),method="loess", se=FALSE)
ggplot((risk9), aes(x=Budburst, y=NEW), stat="identity") + geom_point(aes(x= risk9$Budburst)) +
geom_segment(aes(y = NEW, yend = NEW, x = Budburst, xend = Leaves, col=TX)) +
geom_point(aes(x=Leaves, col=TX)) + geom_point(aes(col=TX)) +
xlab("Budburst to Leaf Out") +
ylab("Species")
# Means and Standard deviations
risk<-risk9%>%
ungroup(NEW, Risk)%>%
dplyr::select(species, Risk)
risk.mean<- risk%>%
group_by(species) %>%
summarise_each(funs(mean))%>%
rename(mean=Risk)
risk.sd<-risk%>%
group_by(species) %>%
summarise_each(funs(sd)) %>%
rename(sd=Risk)
risk.species<-full_join(risk.mean, risk.sd)
tx<-risk9%>%
ungroup(NEW, Risk)%>%
dplyr::select(TX, Risk)
tx.mean<- tx%>%
group_by(TX) %>%
summarise_each(funs(mean))%>%
rename(mean=Risk)
tx.sd<-tx%>%
group_by(TX) %>%
summarise_each(funs(sd)) %>%
rename(sd=Risk)
tx.species<-full_join(tx.mean, tx.sd)
mod<-lm(Risk~species + TX, data=risk9)
display(mod)
View(tx.species)
